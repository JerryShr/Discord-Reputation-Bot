# Discord 買家評價機器人

這是一個專為Discord設計的買家評價機器人，允許用戶對商品進行評價並查看評價統計。

## 功能

- 顯示所有指令
- 顯示將機器人添加到伺服器的邀請連結
- 給予商品評價（交互式設置）
- 快速給予商品評價
- 顯示評價統計（橫向條狀圖 + 平均分）
- 搜尋評論（內容 / 用戶名稱 / 商品名稱）
- 顯示所有評價列表（支持分頁查看）
- 啟動時一同註冊應用程式指令（可設置要全局註冊 / 指定群組）

## 安裝步驟

1. 確保您已安裝 [Node.js](https://nodejs.org/) (v22.15.0 或更高版本)
2. 克隆此存儲庫或下載源代碼
3. 在項目目錄中運行 `npm install` 安裝依賴
4. 複製 `.env.example` 文件為 `.env` 並填寫您的配置
5. 運行 `npm start` 啟動機器人

## 中文顯示問題解決方案

本機器人已針對中文顯示進行了優化，包括：

1. **終端顯示**：使用 `start.bat` 啟動機器人，設置控制台編碼為UTF-8
2. **Discord消息**：使用 `ensureUTF8` 函數處理所有發送到Discord的消息
3. **圖表顯示**：嘗試註冊微軟正黑體字體，確保統計圖表中的中文正確顯示

如果仍然遇到中文顯示問題，請嘗試：

- 確保您的系統安裝了支持中文的字體（如微軟正黑體）
- 確保Discord客戶端設置為使用UTF-8編碼
- 在 `.env` 文件中使用英文設置值，避免中文路徑或ID

## 配置說明

在 `.env` 文件中填寫以下信息：

```
# Discord Bot Token (從Discord開發者門戶獲取)
TOKEN=你的機器人令牌
# 機器人應用ID (從Discord開發者門戶獲取)
CLIENT_ID=你的應用ID
# 評價顯示頻道ID (右鍵點擊頻道 -> 複製ID)
REVIEW_CHANNEL_ID=評價顯示頻道ID
# 是否全局註冊指令 (true/false)
# true: 在所有伺服器註冊指令 (可能需要等待1小時生效)
# false: 僅在指定伺服器註冊指令 (立即生效)
GLOBAL_COMMANDS=false
# 如果不是全局註冊，則指定伺服器ID (右鍵點擊伺服器 -> 複製ID)
GUILD_ID=你的伺服器ID
```

## 使用說明

### 指令權限

#### 管理員指令（需要「管理訊息」權限）

- `/review [商品名稱]` - 創建一個評價按鈕，讓用戶可以給予商品評價
- `/stats [商品名稱]` - 顯示評價統計（橫向條狀圖 + 平均分）
- `/search [關鍵詞]` - 搜尋評論（內容 / 用戶名稱 / 商品名稱）
- `/list [商品名稱] [頁數]` - 顯示所有評價列表，支持分頁查看

#### 所有用戶可用指令

- `/help` - 顯示所有可用的指令
- `/invite` - 顯示將機器人添加到伺服器的邀請連結
- `/quickreview [商品名稱] [評分] [評論]` - 快速給予商品評價，無需使用交互式介面

## 評價流程

1. 管理員使用 `/review [商品名稱]` 創建評價按鈕
2. 用戶點擊按鈕後，會出現交互式介面
3. 用戶填寫評分（1-10）和評論（選填）
4. 評價會顯示在指定的頻道中

## 開發

- `npm start` - 啟動機器人
- `npm run dev` - 使用 nodemon 啟動機器人（自動重啟）

## 依賴

- discord.js - Discord API 客戶端
- dotenv - 環境變量管理
- canvas - 生成評價統計圖表

## 許可證

MIT

